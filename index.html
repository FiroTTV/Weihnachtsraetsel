<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>3eryk? WeihnachtsrÃ¤tsel ðŸŽ„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg: #020617;
      --card-bg: rgba(15, 23, 42, 0.9);
      --border: rgba(148, 163, 184, 0.3);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --accent: #38bdf8;
      --error: #f97373;
      --success: #4ade80;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at top, #1e293b 0, #020617 55%);
      color: var(--text-main);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Snow */
    .snowflake {
      position: fixed;
      top: -10px;
      color: #fff;
      opacity: 0.8;
      user-select: none;
      pointer-events: none;
      z-index: 5;
      animation: fall linear infinite;
    }
    @keyframes fall { to { transform: translateY(110vh); } }

    /* Container */
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 32px 16px 64px;
    }

    .title { text-align: center; margin-bottom: 24px; }
    .title h1 { margin: 0; font-size: clamp(1.8rem, 3vw, 2.4rem); }

    /* Countdown oben */
    #countdown {
      margin-top: 16px;
      font-size: 2.2rem;
      font-weight: 800;
      color: var(--accent);
      text-shadow: 0 0 10px rgba(56, 189, 248, 0.7);
      animation: pulseGlow 2.2s ease-in-out infinite;
    }
    @keyframes pulseGlow {
      0%   { transform: scale(1);   text-shadow: 0 0 12px rgba(56,189,248,0.6); }
      50%  { transform: scale(1.05);text-shadow: 0 0 20px rgba(56,189,248,1);   }
      100% { transform: scale(1);   text-shadow: 0 0 12px rgba(56,189,248,0.6); }
    }

    /* Cards */
    .card {
      background: var(--card-bg);
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 20px 18px;
      margin-bottom: 18px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.5);
    }
    .card-header { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
    .badge {
      font-size: 0.75rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      color: var(--text-muted);
    }

    iframe {
      width: 100%; max-width: 600px; height: 338px;
      margin: 0 auto; display: block;
      border-radius: 12px; border: none;
      background: #020617;
    }

    /* QR CODE BOX */
    .qr-box {
      padding: 18px;
      margin: 20px 0;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 12px;
      font-size: 1.05rem;
    }

    /* Burger MenÃ¼ Button */
    #burger-btn {
      position: fixed;
      right: 22px;
      top: 22px;
      z-index: 9999;
      cursor: pointer;
      font-size: 28px;
      background: rgba(0,0,0,0.4);
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.15);
    }

    /* Side Menu */
    #side-menu {
      position: fixed;
      right: -260px;
      top: 0;
      width: 240px;
      height: 100vh;
      background: rgba(15,23,42,0.97);
      border-left: 1px solid rgba(255,255,255,0.12);
      padding: 20px;
      transition: 0.3s ease;
      z-index: 99999;
    }
    #side-menu.active { right: 0; }

    #side-menu ul { list-style: none; padding: 0; margin: 0; }
    #side-menu li {
      padding: 12px;
      margin-bottom: 10px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 10px;
      cursor: pointer;
    }

    #side-menu li.locked {
      opacity: 0.4;
      cursor: not-allowed;
    }

    /* Overlay */
    #menu-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      display: none;
      z-index: 9998;
    }
    #menu-overlay.active { display: block !important; }
  </style>
</head>

<body>

<!-- Snow -->
<script>
function createSnowflake() {
  const s=document.createElement("div");
  s.className="snowflake";
  s.textContent="â„";
  s.style.left=Math.random()*100+"vw";
  s.style.fontSize=10+Math.random()*18+"px";
  s.style.animationDuration=4+Math.random()*6+"s";
  s.style.opacity=0.4+Math.random()*0.4;
  document.body.appendChild(s);
  setTimeout(()=>s.remove(),11000);
}
setInterval(createSnowflake,200);
</script>

<!-- BURGER BUTTON -->
<div id="burger-btn">â˜°</div>

<!-- SIDE MENU -->
<nav id="side-menu">
  <ul>
    <li data-target="puzzle-0" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="puzzle-1" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="puzzle-2" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="puzzle-3" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="puzzle-4" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="puzzle-5" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="final-card" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
  </ul>
</nav>

<div id="menu-overlay"></div>

<div class="container">
  <div class="title">
    <h1>ðŸŽ„ 3eryk? WeihnachtsrÃ¤tsel ðŸŽ„</h1>
    <div id="countdown">Lade Countdown...</div>
  </div>
  <!-- INTRO VIDEO -->
  <div class="card">
    <div class="card-header">
      <span class="badge">Intro</span>
      <h2>Willkommen!</h2>
    </div>

    <iframe
      src="https://www.youtube.com/embed/TGvnbko2Jio?si=z0f59smM_qRPTszH"
      allowfullscreen></iframe>
  </div>

  <!-- QR-CODE BEREICH (NEU) -->
  <div class="qr-box">
    <strong>QR-Code:</strong><br>
    Findet alle Teile des QR-Codes mithilfe von Firoâ€¦
  </div>

  <!-- QUIZ â€“ RÃ„TSEL 1 -->
  <div class="card puzzle-card hidden" id="puzzle-0" data-index="0">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 1</span>
      <h2>Quiz â€“ 8 Fragen</h2>
    </div>

    <p id="quiz-summary">0 von 8 gelÃ¶st</p>

    <!-- Frage 1 -->
    <div class="question-row">
      <p>1. Aus wie vielen Alben besteht die Trilogie von TheWeeknd?</p>
      <input id="q1" placeholder="Antwort eingeben...">
      <button onclick="checkQuiz(1)">PrÃ¼fen</button>
      <div id="m1" class="message"></div>
    </div>

    <!-- Frage 2 -->
    <div class="question-row">
      <p>2. Wann war der erste Call in der Discord Gruppe 3eryk?</p>
      <input id="q2" placeholder="Antwort eingeben... (TT.MM.JJJJ)">
      <button onclick="checkQuiz(2)">PrÃ¼fen</button>
      <div id="m2" class="message"></div>
    </div>

    <!-- Frage 3 -->
    <div class="question-row">
      <p>3. Rot....?</p>
      <input id="q3" placeholder="ganzen Satz eingeben">
      <button onclick="checkQuiz(3)">PrÃ¼fen</button>
      <div id="m3" class="message"></div>
    </div>

    <!-- Frage 4 -->
    <div class="question-row">
      <p>4. Frage...?</p>
      <input id="q4" placeholder="Antwort eingeben...">
      <button onclick="checkQuiz(4)">PrÃ¼fen</button>
      <div id="m4" class="message"></div>
    </div>

    <!-- Frage 5 -->
    <div class="question-row">
      <p>5. Rabsi, Manuel, Firo... Doch welche Endung ist die schÃ¶nste?</p>
      <input id="q5" placeholder="Buchstabe eingeben">
      <button onclick="checkQuiz(5)">PrÃ¼fen</button>
      <div id="m5" class="message"></div>
    </div>

    <!-- Frage 6 -->
    <div class="question-row">
      <p>6. Firos aktueller Lieblingsbuchstabe...?</p>
      <input id="q6" placeholder="Antwort eingeben...">
      <button onclick="checkQuiz(6)">PrÃ¼fen</button>
      <div id="m6" class="message"></div>
    </div>

    <!-- Frage 7 -->
    <div class="question-row">
      <p>7. Firo findet Namen seit Neuestem attraktiv... Doch welcher Buchstabe ist der verbreitetste?</p>
      <input id="q7" placeholder="Antwort eingeben...">
      <button onclick="checkQuiz(7)">PrÃ¼fen</button>
      <div id="m7" class="message"></div>
    </div>

    <!-- Frage 8 -->
    <div class="question-row">
      <p>8. Wie viele Medien wurden in der WhatsApp-Gruppe geteilt? (MC: 23 / 69 / 83 / 47)</p>
      <input id="q8" placeholder="Antwort eingeben...">
      <button onclick="checkQuiz(8)">PrÃ¼fen</button>
      <div id="m8" class="message"></div>
    </div>
  </div>

  <!-- NÃ„CHSTES RÃ„TSEL BOX -->
  <div class="card" id="next-unlock-card">
    <div class="card-header">
      <span class="badge">Info</span>
      <h2>NÃ¤chstes RÃ¤tsel</h2>
    </div>

    <div id="next-unlock-text">Lade...</div>
    <div id="next-unlock-countdown"></div>

    <div id="next-unlock-icon"
         style="font-size:32px;margin-top:10px;opacity:0.8;text-align:center;">
      ðŸ”’
    </div>
  </div>

  <!-- RÃ„TSEL 2 -->
  <div class="card puzzle-card hidden" id="puzzle-1" data-index="1">
    <div class="card-header"><span class="badge">RÃ¤tsel 2</span><h2>RÃ¤tsel erscheint am 08.12.</h2></div>
    <p>Wird automatisch freigeschaltet.</p>
  </div>

  <!-- RÃ„TSEL 3 -->
  <div class="card puzzle-card hidden" id="puzzle-2" data-index="2">
    <div class="card-header"><span class="badge">RÃ¤tsel 3</span><h2>RÃ¤tsel erscheint am 10.12.</h2></div>
    <p>Wird automatisch freigeschaltet.</p>
  </div>

  <!-- RÃ„TSEL 4 -->
  <div class="card puzzle-card hidden" id="puzzle-3" data-index="3">
    <div class="card-header"><span class="badge">RÃ¤tsel 4</span><h2>RÃ¤tsel erscheint am 16.12.</h2></div>
    <p>Wird automatisch freigeschaltet.</p>
  </div>

  <!-- RÃ„TSEL 5 -->
  <div class="card puzzle-card hidden" id="puzzle-4" data-index="4">
    <div class="card-header"><span class="badge">RÃ¤tsel 5</span><h2>RÃ¤tsel erscheint am 22.12.</h2></div>
    <p>Wird automatisch freigeschaltet.</p>
  </div>

  <!-- RÃ„TSEL 6 â€“ SPOTIFY -->
  <div class="card puzzle-card hidden" id="puzzle-5" data-index="5">
    <div class="card-header"><span class="badge">RÃ¤tsel 6</span><h2>Spotify RÃ¤tsel</h2></div>

    <p>Song-Code eingeben (3 Buchstaben):</p>

    <div class="question-row">
      <input type="text" id="sp1" maxlength="1" placeholder="1. Buchstabe">
      <input type="text" id="sp2" maxlength="1" placeholder="2. Buchstabe" style="margin-top:10px;">
      <input type="text" id="sp3" maxlength="1" placeholder="3. Buchstabe" style="margin-top:10px;">
      <button onclick="checkSpotify()">PrÃ¼fen</button>
      <div id="sp-msg" class="message"></div>
    </div>
  </div>

  <!-- FINALES LÃ–SUNGSWORT -->
  <div class="card hidden" id="final-card">
    <div class="card-header"><span class="badge">Ende</span><h2>Finales LÃ¶sungswort</h2></div>

    <p>Hier endgÃ¼ltiges LÃ¶sungswort eingeben:</p>
    <input id="final-input" type="text">
    <button onclick="checkFinal()">PrÃ¼fen</button>
    <div id="final-msg" class="message"></div>
  </div>

  <!-- RESET -->
  <button id="reset-progress">Fortschritt zurÃ¼cksetzen</button>

</div> <!-- /container -->
<script>
// ---------- BURGER MENU ----------
const burgerBtn = document.getElementById("burger-btn");
const sideMenu = document.getElementById("side-menu");
const menuOverlay = document.getElementById("menu-overlay");

burgerBtn.onclick = () => {
  sideMenu.classList.add("active");
  menuOverlay.classList.add("active");
};

menuOverlay.onclick = () => {
  sideMenu.classList.remove("active");
  menuOverlay.classList.remove("active");
};

// Click on menu item
document.querySelectorAll("#side-menu li").forEach(li => {
  li.addEventListener("click", () => {
    if (li.classList.contains("locked")) return;
    const target = li.getAttribute("data-target");
    if (!target) return;
    document.getElementById(target).scrollIntoView({ behavior: "smooth" });

    // close menu
    sideMenu.classList.remove("active");
    menuOverlay.classList.remove("active");
  });
});


// ---------- UNLOCK CONFIG ----------
const unlockTimes = [
  new Date("December 1, 2025 18:00:00"), // RÃ¤tsel 1
  new Date("December 8, 2025 18:00:00"), // RÃ¤tsel 2
  new Date("December 10, 2025 18:00:00"), // RÃ¤tsel 3
  new Date("December 16, 2025 18:00:00"), // RÃ¤tsel 4
  new Date("December 22, 2025 18:00:00"), // RÃ¤tsel 5
  new Date("December 28, 2025 20:00:00")  // RÃ¤tsel 6 (Spotify)
];

const puzzleCards = document.querySelectorAll(".puzzle-card");


// ---------- UPDATE UNLOCKS ----------
function updatePuzzles() {
  const now = new Date();

  puzzleCards.forEach(card => {
    const idx = parseInt(card.dataset.index);
    const unlockTime = unlockTimes[idx];

    const menuItem = document.querySelector(`#side-menu li[data-target="${card.id}"]`);

    if (now >= unlockTime || isAdminModeActive()) {
      card.classList.remove("hidden");

      // Show proper name
      if (menuItem) {
        let properName = card.querySelector(".card-header h2").textContent;
        menuItem.classList.remove("locked");
        menuItem.innerHTML = properName;
      }
    } else {
      card.classList.add("hidden");

      // Locked in menu
      if (menuItem) {
        menuItem.classList.add("locked");
        menuItem.innerHTML = "ðŸ”’ Gesperrt";
      }
    }
  });

  updateNextUnlockBox();
}

setInterval(updatePuzzles, 1000);
updatePuzzles();


// ---------- NEXT UNLOCK BOX ----------
function updateNextUnlockBox() {
  const now = new Date();
  const nextBox = document.getElementById("next-unlock-card");
  const textEl = document.getElementById("next-unlock-text");
  const cdEl   = document.getElementById("next-unlock-countdown");
  const iconEl = document.getElementById("next-unlock-icon");

  let next = unlockTimes.find(t => now < t);

  // Wenn alles frei ist â†’ Box ausblenden
  if (!next) {
    nextBox.style.display = "none";
    return;
  }

  let diff = next - now;

  let d = Math.floor(diff / (1000*60*60*24));
  let h = Math.floor((diff / (1000*60*60)) % 24);
  let m = Math.floor((diff / (1000*60)) % 60);
  let s = Math.floor((diff / 1000) % 60);

  textEl.textContent = "NÃ¤chstes RÃ¤tsel wird freigeschaltet in:";

  let out = "";
  if (d > 0) out += d + "d ";
  if (h > 0) out += h + "h ";
  if (m > 0) out += m + "m ";
  out += s + "s";

  cdEl.textContent = out;
}


// ---------- COUNTDOWN OBEN ----------
function updateMainCountdown() {
  const target = new Date("December 28, 2025 20:00:00");
  const now = new Date();
  const cd = document.getElementById("countdown");

  let diff = target - now;
  if (diff < 0) {
    cd.textContent = "ðŸŽ„ Frohe Weihnachten! ðŸŽ„";
    return;
  }

  let d = Math.floor(diff / (1000*60*60*24));
  let h = Math.floor((diff / (1000*60*60)) % 24);
  let m = Math.floor((diff / (1000*60)) % 60);
  let s = Math.floor((diff / 1000) % 60);

  cd.textContent = `${d}d ${h}h ${m}m ${s}s`;
}
setInterval(updateMainCountdown, 1000);
updateMainCountdown();


// ---------- QUIZ ----------
const quizSolutions = {
  1: { answer: "3", letter: "3" },
  2: { answer: "25.09.2024", letter: "e" },
  3: { answer: "rot ist meine lieblings zahl im ganzen alphabet", letter: "r" },
  4: { answer: "wann", letter: "y" },
  5: { answer: "i", letter: "k" },
  6: { answer: "t", letter: "?" },
  7: { answer: "e", letter: "2" },
  8: { answer: "47", letter: "0" }
};

let quizProgress = JSON.parse(localStorage.getItem("quizProgress") || "{}");
let collectedLetters = JSON.parse(localStorage.getItem("collectedLetters") || []);

// Writes summary & restores answers
function updateQuizUI() {
  const summary = document.getElementById("quiz-summary");
  const solved = Object.keys(quizProgress).length;
  summary.textContent = `${solved} von 8 gelÃ¶st`;

  Object.keys(quizProgress).forEach(q => {
    const msg = document.getElementById("m" + q);
    msg.textContent = "Richtig! Buchstabe erhalten: " + quizProgress[q];
    msg.className = "message success";
  });
}
updateQuizUI();

function checkQuiz(num) {
  const input = document.getElementById("q" + num).value.trim().toLowerCase();
  const msg   = document.getElementById("m" + num);

  const correct = quizSolutions[num].answer.toLowerCase();
  const letter  = quizSolutions[num].letter;

  if (input === correct) {
    msg.textContent = "Richtig! Buchstabe erhalten: " + letter;
    msg.className = "message success";

    quizProgress[num] = letter;
    localStorage.setItem("quizProgress", JSON.stringify(quizProgress));

    if (!collectedLetters.includes(letter)) {
      collectedLetters.push(letter);
      localStorage.setItem("collectedLetters", JSON.stringify(collectedLetters));
    }

  } else {
    msg.textContent = "Falsch!";
    msg.className = "message error";
  }

  updateQuizUI();
}


// ---------- SPOTIFY ----------
function checkSpotify() {
  const a = document.getElementById("sp1").value.toLowerCase();
  const b = document.getElementById("sp2").value.toLowerCase();
  const c = document.getElementById("sp3").value.toLowerCase();
  const msg = document.getElementById("sp-msg");

  if (a === "s" && b === "t" && c === "a") {
    msg.textContent = "Richtig!";
    msg.className = "message success";

    if (!collectedLetters.includes("5"))
      collectedLetters.push("5");

    localStorage.setItem("collectedLetters", JSON.stringify(collectedLetters));
  } else {
    msg.textContent = "Falsch!";
    msg.className = "message error";
  }
}


// ---------- FINALES WORT ----------
function checkFinal() {
  const input = document.getElementById("final-input").value.trim();
  const msg   = document.getElementById("final-msg");

  const correct = "3eryk?2025Weihnachtsedition";

  if (input === correct) {
    msg.textContent = "Korrekt! ðŸŽ‰";
    msg.className = "message success";
  } else {
    msg.textContent = "Falsch!";
    msg.className = "message error";
  }
}


// ---------- ADMIN MODE ----------
function isAdminModeActive() {
  return localStorage.getItem("adminMode") === "true";
}

document.addEventListener("keydown", e => {
  if (e.key === "F" && e.ctrlKey) {
    let pw = prompt("Admin-Passwort:");
    if (pw === "firobestadmin") {
      localStorage.setItem("adminMode", "true");
      alert("Admin-Modus aktiviert!");
    }
  }
});


// ---------- RESET ----------
document.getElementById("reset-progress").onclick = () => {
  localStorage.clear();
  alert("Fortschritt gelÃ¶scht!");
  location.reload();
};
</script>

</body>
</html>
