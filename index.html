<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>3eryk? Weihnachtsedition</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg: #020617;
  --card-bg: rgba(15,23,42,0.9);
  --border: rgba(148,163,184,0.3);
  --text-main: #e5e7eb;
  --text-muted: #9ca3af;
  --accent: #38bdf8;
  --error: #f97373;
  --success: #4ade80;
}

body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: radial-gradient(circle at top, #1e293b 0, #020617 55%);
  color: var(--text-main);
  min-height: 100vh;
  overflow-x: hidden;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 32px 16px 64px;
}

.title {
  text-align: center;
  margin-bottom: 24px;
}

.title h1 {
  margin: 0;
  font-size: clamp(1.8rem, 3vw, 2.4rem);
}

/* Countdown */
#countdown {
  margin-top: 16px;
  font-size: 2.2rem;
  font-weight: 800;
  color: var(--accent);
  text-shadow: 0 0 12px rgba(56,189,248,0.7);
}

/* Cards */
.card {
  background: var(--card-bg);
  border-radius: 16px;
  border: 1px solid var(--border);
  padding: 20px 18px;
  margin-bottom: 18px;
}

.card-header {
  display: flex;
  align-items: center;
  gap: 10px;
}

.badge {
  font-size: .75rem;
  padding: 3px 8px;
  border-radius: 999px;
  border: 1px solid var(--border);
  color: var(--text-muted);
}

/* Inputs */
input[type="text"],
input[type="password"] {
  width: 100%;
  box-sizing: border-box;
  padding: 10px 14px;
  font-size: 1rem;
  border-radius: 10px;
  border: 1px solid rgba(148,163,184,0.25);
  background: rgba(255,255,255,0.06);
  color: #e5e7eb;
  margin-top: 6px;
}

.spotify-letter {
  width: 60px;
  text-align: center;
  font-size: 1.2rem;
}

/* Buttons */
button {
  padding: 8px 18px;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 600;
  color: white;
  background: linear-gradient(90deg, #3b82f6, #a855f7);
  margin-top: 6px;
}

button:disabled { opacity: 0.6; cursor: not-allowed; }

.hidden { display: none !important; }

/* Progress letters */
.letters-progress {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.letters-progress span {
  width: 22px;
  padding: 3px 0;
  text-align: center;
  border-radius: 6px;
  background: rgba(15,23,42,0.7);
  border: 1px solid rgba(148,163,184,0.35);
}

.letters-progress span.filled {
  border-color: var(--accent);
}

/* Burger Menu */
#burger {
  position: fixed;
  top: 18px;
  right: 18px;
  width: 34px;
  height: 28px;
  cursor: pointer;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

#burger div {
  width: 100%;
  height: 4px;
  background: #e5e7eb;
  border-radius: 4px;
  transition: 0.3s;
}

#burger.open div:nth-child(1) { transform: translateY(12px) rotate(45deg); }
#burger.open div:nth-child(2) { opacity: 0; }
#burger.open div:nth-child(3) { transform: translateY(-12px) rotate(-45deg); }

#side-menu {
  position: fixed;
  top: 0;
  right: -300px;
  width: 260px;
  height: 100vh;
  background: rgba(15,23,42,0.98);
  padding: 22px;
  transition: right 0.35s ease;
  z-index: 9998;
  border-left: 1px solid rgba(148,163,184,0.35);
}

#side-menu.open { right: 0; }

#side-menu a {
  display: block;
  padding: 12px 0;
  color: #e5e7eb;
  text-decoration: none;
  border-bottom: 1px solid rgba(148,163,184,0.2);
}

.message { margin-top:6px; }
.message.error { color:#f97373; }
.message.success { color:#4ade80; }

#admin-banner {
  padding: 10px 14px;
  margin-bottom: 16px;
  border-radius: 12px;
  background: linear-gradient(90deg, #b91c1c, #f97316);
  font-weight: 700;
  text-align: center;
  display: none;
}
</style>
</head>

<body>

<!-- BURGER ICON -->
<div id="burger">
  <div></div><div></div><div></div>
</div>

<!-- SIDE MENU -->
<nav id="side-menu">
  <h3>ðŸ”Ž Navigation</h3>
  <div id="side-menu-links"></div>
</nav>

<div class="container">

  <div class="title">
    <h1>3eryk? Weihnachtsedition</h1>
    <div id="countdown"></div>
  </div>

  <!-- ADMIN BANNER -->
  <div id="admin-banner">ADMIN MODUS AKTIV</div>

  <!-- ADMIN LOGIN -->
  <div class="card">
    <div class="card-header">
      <span class="badge">Admin</span>
      <h2>Admin Login</h2>
    </div>
    <input type="password" id="admin-pass" placeholder="Passwort">
    <button id="admin-btn">Login</button>
    <div id="admin-msg" class="message"></div>
  </div>

  <!-- INTRO -->
  <div class="card">
    <div class="card-header">
      <span class="badge">Intro</span>
      <h2>Willkommen!</h2>
    </div>
    <iframe src="https://www.youtube.com/embed/TGvnbko2Jio" allowfullscreen></iframe>
  </div>

  <!-- FORTSCHRITT -->
  <div class="card">
    <div class="card-header">
      <span class="badge">Fortschritt</span>
      <h2>Gesammelte Zeichen</h2>
    </div>
    <div class="letters-progress" id="letters-progress">
      <span>_</span><span>_</span><span>_</span><span>_</span>
      <span>_</span><span>_</span><span>_</span><span>_</span>
      <span>_</span><span>_</span><span>_</span><span>_</span>
      <span>_</span><span>_</span><span>_</span><span>_</span>
      <span>_</span><span>_</span><span>_</span><span>_</span>
      <span>_</span><span>_</span><span>_</span><span>_</span>
      <span>_</span><span>_</span><span>_</span>
    </div>
  </div>

  <!-- RÃ„TSEL 1 -->
  <div class="card puzzle-card" id="puzzle1" data-index="0">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 1</span>
      <h2>Quiz â€“ 8 Fragen</h2>
    </div>

    <!-- deine 8 Fragen (unverÃ¤ndert!) -->

    <div id="quiz-summary" class="message"></div>
  </div>

  <!-- QR-CODE -->
  <div class="card" id="qr-section">
    <div class="card-header">
      <span class="badge">QR-Code</span>
      <h2>QR-Code</h2>
    </div>
    <p>Findet die restlichen Teile mithilfe von Firoâ€¦</p>

    <img src="data:image/png;base64,iVBOR..." 
         alt="QR Code Teil"
         style="width:260px; display:block; margin:12px auto; border-radius:12px;">
  </div>

  <!-- AB HIER KOMMT RÃ„TSEL 2 IN TEIL 2 -->
  <!-- RÃ„TSEL 2 â€“ MINECRAFT (MODERNISIERT) -->
  <div class="card puzzle-card hidden" id="puzzle2" data-index="1">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 2</span>
      <h2>Minecraft</h2>
    </div>

    <p>
      Begebt euch heute in die Blockartige Weltâ€¦ Doch nur eine Person wird benÃ¶tigtâ€¦<br>
      Ihr sucht 4 Zeichenâ€¦ Die euch am Ende einen SchlÃ¼ssel sein werdenâ€¦<br>
      Achtet auf ALLES, was euch unrichtig erscheintâ€¦ Denn nur soâ€¦ wird die LÃ¶sung Euer seinâ€¦
    </p>

    <div style="display:flex; gap:10px; margin-top:12px;">
      <input id="r2-i1" maxlength="1" class="spotify-letter" autocomplete="off">
      <input id="r2-i2" maxlength="1" class="spotify-letter" autocomplete="off">
      <input id="r2-i3" maxlength="1" class="spotify-letter" autocomplete="off">
      <input id="r2-i4" maxlength="1" class="spotify-letter" autocomplete="off">
    </div>

    <button id="r2-check" style="margin-top:12px;">PrÃ¼fen</button>

    <div id="r2-msg" class="message"></div>
    <div id="r2-letters" class="letter-display hidden"></div>
  </div>



  <!-- ========================================================= -->
  <!-- =====================   RÃ„TSEL 3   ======================= -->
  <!-- ========================================================= -->

  <div class="card puzzle-card hidden" id="puzzle3" data-index="2">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 3</span>
      <h2>Spotify Songrate RÃ¤tsel</h2>
    </div>

    <p>HÃ¶rt genau hin, erkennt den Song und gebt den Titel ein.</p>

    <audio controls style="width:100%; margin:10px 0;">
      <source src="spotify1.mp3" type="audio/mpeg">
    </audio>

    <input type="text" placeholder="Songtitel eingeben">
    <button>PrÃ¼fen</button>
    <div class="message"></div>
    <div class="letter-display hidden"></div>
  </div>



  <!-- ========================================================= -->
  <!-- =====================   RÃ„TSEL 4   ======================= -->
  <!-- ========================================================= -->

  <div class="card puzzle-card hidden" id="puzzle4" data-index="3">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 4</span>
      <h2>LogikrÃ¤tsel</h2>
    </div>

    <p>LÃ¶se das LogikrÃ¤tsel und gib die richtige Antwort ein.</p>

    <input type="text" placeholder="Antwort eingeben">
    <button>PrÃ¼fen</button>
    <div class="message"></div>
    <div class="letter-display hidden"></div>
  </div>



  <!-- ========================================================= -->
  <!-- =====================   RÃ„TSEL 5   ======================= -->
  <!-- ========================================================= -->

  <div class="card puzzle-card hidden" id="puzzle5" data-index="4">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 5</span>
      <h2>Kopfrechen RÃ¤tsel</h2>
    </div>

    <p>Eine kleine Matheaufgabeâ€¦</p>

    <input type="text" placeholder="Antwort eingeben">
    <button>PrÃ¼fen</button>
    <div class="message"></div>
    <div class="letter-display hidden"></div>
  </div>



  <!-- ========================================================= -->
  <!-- =====================   RÃ„TSEL 6   ======================= -->
  <!-- ========================================================= -->

  <div class="card puzzle-card hidden" id="puzzle6" data-index="5">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 6</span>
      <h2>EndrÃ¤tsel</h2>
    </div>

    <p>Der letzte Hinweisâ€¦</p>

    <input type="text" placeholder="Antwort eingeben">
    <button>PrÃ¼fen</button>
    <div class="message"></div>
    <div class="letter-display hidden"></div>
  </div>



  <!-- ========================================================= -->
  <!-- ========================  FINALE  ======================== -->
  <!-- ========================================================= -->

  <div class="card hidden" id="final-card">
    <div class="card-header">
      <span class="badge">Finale</span>
      <h2>Das groÃŸe LÃ¶sungswort</h2>
    </div>

    <input id="final-input" type="text" placeholder="LÃ¶sungswort eingeben">
    <button id="final-button">PrÃ¼fen</button>

    <div id="final-message" class="message"></div>

    <div id="final-video-wrapper" class="hidden" style="margin-top:18px;">
      <p>ðŸŽ‰ GlÃ¼ckwunsch! ðŸŽ‰</p>
      <iframe src="https://www.youtube.com/embed/TGvnbko2Jio" allowfullscreen></iframe>
    </div>
  </div>



  <!-- ========================================================= -->
  <!-- ================= NEXT UNLOCK INFO ======================= -->
  <!-- ========================================================= -->

  <div class="card" id="next-unlock-card">
    <div class="card-header">
      <span class="badge">Info</span>
      <h2>NÃ¤chstes RÃ¤tsel</h2>
    </div>
    <p id="next-unlock-text">Ladeâ€¦</p>
    <div id="next-unlock-countdown"></div>
  </div>

  <button id="reset-progress">ðŸ”„ Fortschritt zurÃ¼cksetzen</button>

</div> <!-- container -->


<!-- AB HIER BEGINNT TEIL 3 (SCRIPT) -->
<script>
/* ================================================================
   DUMMY SOUNDS (funktionieren Ã¼berall, keine Dateien nÃ¶tig)
================================================================ */

function playClick() {
  const a = new Audio("data:audio/wav;base64,UklGRhQAAABXQVZFZm10IBAAAAABAAEAIlYAAESsAAACABAAZGF0YQgAAAABAQEB");
  a.volume = 0.4;
  a.play();
}

function playSuccess() {
  const a = new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAIlYAABFeAAACABAAZGF0YQwAAAABAQEBAQEB");
  a.volume = 0.6;
  a.play();
}

function playError() {
  const a = new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAIlYAABFeAAACABAAZGF0YQwAAAABAQEB");
  a.volume = 0.5;
  a.play();
}



/* ================================================================
   GLOBALER PROGRESS
================================================================ */

let progress = JSON.parse(localStorage.getItem("XMASRIDDLE_GLOBAL") || "{}");

function saveProgress() {
  localStorage.setItem("XMASRIDDLE_GLOBAL", JSON.stringify(progress));
}

const lettersSpans = document.getElementById("letters-progress").children;
let nextLetterIndex = 0;

function addLetter(ch) {
  if (nextLetterIndex < lettersSpans.length) {
    lettersSpans[nextLetterIndex].textContent = ch;
    lettersSpans[nextLetterIndex].classList.add("filled");
    nextLetterIndex++;
  }
}



/* ================================================================
   COUNTDOWN (Titel)
================================================================ */

function updateCountdown() {
  const el = document.getElementById("countdown");
  if (!el) return;

  const target = new Date("December 28, 2025 20:00:00").getTime();
  const diff = target - Date.now();

  if (diff <= 0) {
    el.textContent = "ðŸŽ„ Frohe Weihnachten!";
    return;
  }

  const d = Math.floor(diff / 86400000);
  const h = Math.floor((diff % 86400000) / 3600000);
  const m = Math.floor((diff % 3600000) / 60000);
  const s = Math.floor((diff % 60000) / 1000);

  el.textContent = `${d}T ${h}h ${m}m ${s}s`;
}
setInterval(updateCountdown, 1000);
updateCountdown();



/* ================================================================
   ADMIN SYSTEM
================================================================ */

let ADMIN_MODE = false;
const ADMIN_PASSWORD = "SuperYK2025";  /* dein Passwort */

document.getElementById("admin-btn").addEventListener("click", () => {
  const pw = document.getElementById("admin-pass").value.trim();

  if (pw === ADMIN_PASSWORD) {
    ADMIN_MODE = true;
    document.getElementById("admin-banner").style.display = "block";
    document.getElementById("admin-msg").textContent = "Admin-Modus aktiviert!";
    document.getElementById("admin-msg").className = "message success";

    /* Option C: Alles bei RÃ¤tsel 2 sofort aktiv */
    enablePuzzle2();
    updateVisibility();
  } else {
    document.getElementById("admin-msg").textContent = "Falsch!";
    document.getElementById("admin-msg").className = "message error";
    playError();
  }
});



/* ================================================================
   UNLOCK-ZEITEN (mit RÃ¤tsel 2 â†’ 8.12., 21:00 Uhr)
================================================================ */

const unlockTimes = {
  0: new Date("December 1, 2025 18:00").getTime(),
  1: new Date("December 8, 2025 21:00").getTime(),
  2: new Date("December 10, 2025 18:00").getTime(),
  3: new Date("December 16, 2025 18:00").getTime(),
  4: new Date("December 22, 2025 18:00").getTime(),
  5: new Date("December 28, 2025 18:00").getTime()
};

function isUnlocked(i) {
  return ADMIN_MODE || Date.now() >= unlockTimes[i];
}



/* ================================================================
   VISIBILITY / PUZZLE FREISCHALTUNG
================================================================ */

function updateVisibility() {
  const p1 = document.getElementById("puzzle1");
  const p2 = document.getElementById("puzzle2");
  const p3 = document.getElementById("puzzle3");
  const p4 = document.getElementById("puzzle4");
  const p5 = document.getElementById("puzzle5");
  const p6 = document.getElementById("puzzle6");

  /* Alles verstecken */
  [p1, p2, p3, p4, p5, p6].forEach(el => el.classList.add("hidden"));
  document.getElementById("final-card").classList.add("hidden");

  /* Admin sieht alles */
  if (ADMIN_MODE) {
    [p1, p2, p3, p4, p5, p6].forEach(el => el.classList.remove("hidden"));
    document.getElementById("final-card").classList.remove("hidden");
    enablePuzzle2();
    updateNextUnlockCard();
    return;
  }

  if (isUnlocked(0)) p1.classList.remove("hidden");
  if (isUnlocked(1) && progress.solvedPuzzles?.[0]) {
    p2.classList.remove("hidden");
    enablePuzzle2();
  }
  if (isUnlocked(2) && progress.solvedPuzzles?.[1]) p3.classList.remove("hidden");
  if (isUnlocked(3) && progress.solvedPuzzles?.[2]) p4.classList.remove("hidden");
  if (isUnlocked(4) && progress.solvedPuzzles?.[3]) p5.classList.remove("hidden");
  if (isUnlocked(5) && progress.solvedPuzzles?.[4]) p6.classList.remove("hidden");

  /* Finale freischalten */
  if ([0,1,2,3,4,5].every(i => progress.solvedPuzzles?.[i])) {
    document.getElementById("final-card").classList.remove("hidden");
  }

  updateNextUnlockCard();
}
setInterval(updateVisibility, 15000);



/* ================================================================
   RÃ„TSEL 2 â€” MINECRAFT (4 Felder, komplett neu)
================================================================ */

function enablePuzzle2() {
  ["r2-i1","r2-i2","r2-i3","r2-i4","r2-check"].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.disabled = false;   // Option C: sofort aktiv
  });
}

document.getElementById("r2-check").addEventListener("click", () => {
  playClick();

  const v1 = document.getElementById("r2-i1").value.trim().toLowerCase();
  const v2 = document.getElementById("r2-i2").value.trim().toLowerCase();
  const v3 = document.getElementById("r2-i3").value.trim().toLowerCase();
  const v4 = document.getElementById("r2-i4").value.trim().toLowerCase();

  const code = v1 + v2 + v3 + v4;
  const solution = "rnch";

  const msg = document.getElementById("r2-msg");
  const display = document.getElementById("r2-letters");

  if (code !== solution) {
    msg.textContent = "Falsch!";
    msg.className = "message error";
    display.classList.add("hidden");
    playError();
    return;
  }

  /* KORREKT */
  msg.textContent = "Richtig!";
  msg.className = "message success";
  playSuccess();

  display.textContent = "Gefundene Zeichen: R N C H";
  display.classList.remove("hidden");

  /* Progress speichern */
  progress.solvedPuzzles ||= {};
  progress.solvedPuzzles[1] = true;

  progress.letters ||= [];
  ["r","n","c","h"].forEach(ch => {
    addLetter(ch);
    progress.letters.push(ch);
  });

  saveProgress();

  /* Felder deaktivieren */
  ["r2-i1","r2-i2","r2-i3","r2-i4","r2-check"].forEach(id => {
    document.getElementById(id).disabled = true;
  });
});



/* ================================================================
   STANDARD PRÃœFLOGIK FÃœR RÃ„TSEL 3â€“6
================================================================ */

document.querySelectorAll(".puzzle-card").forEach(card => {
  const index = parseInt(card.dataset.index);
  const button = card.querySelector("button");
  const input = card.querySelector("input[type='text']");
  const msg = card.querySelector(".message");
  const letters = card.querySelector(".letter-display");

  if (index === 1) return; // RÃ¤tsel 2 hat eigene Logik

  if (!button || !input) return;

  button.addEventListener("click", () => {
    playClick();

    const user = input.value.trim().toLowerCase();
    const solution = (progress.solutions && progress.solutions[index])
                      || input.dataset.solution
                      || "";

    if (user === solution.toLowerCase()) {
      msg.textContent = "Richtig!";
      msg.className = "message success";
      playSuccess();

      letters.textContent = "Zeichen gefunden!";
      letters.classList.remove("hidden");

      progress.solvedPuzzles ||= {};
      progress.solvedPuzzles[index] = true;

      saveProgress();
      input.disabled = true;
      button.disabled = true;

    } else {
      msg.textContent = "Falsch!";
      msg.className = "message error";
      playError();
    }
  });
});



/* ================================================================
   FINALE
================================================================ */

document.getElementById("final-button").addEventListener("click", () => {
  playClick();

  const input = document.getElementById("final-input").value.trim();
  const correct = "3eryk?2025Weihnachtsedition";

  if (input.toLowerCase() === correct.toLowerCase()) {
    playSuccess();
    document.getElementById("final-message").textContent = "Richtig!";
    document.getElementById("final-message").className = "message success";
    document.getElementById("final-video-wrapper").classList.remove("hidden");

    progress.final = true;
    saveProgress();
  } else {
    playError();
    document.getElementById("final-message").textContent = "Falsch!";
    document.getElementById("final-message").className = "message error";
  }
});



/* ================================================================
   NÃ„CHSTES RÃ„TSEL â€“ INFO CARD
================================================================ */

function updateNextUnlockCard() {
  const card = document.getElementById("next-unlock-card");
  const text = document.getElementById("next-unlock-text");
  const cd = document.getElementById("next-unlock-countdown");

  if (ADMIN_MODE) {
    card.style.display = "none";
    return;
  }

  const now = Date.now();
  const upcoming = Object.keys(unlockTimes)
    .map(Number)
    .filter(i => now < unlockTimes[i]);

  if (upcoming.length === 0) {
    card.style.display = "none";
    return;
  }

  const next = Math.min(...upcoming);
  const date = new Date(unlockTimes[next]);
  text.innerHTML = `ðŸ”’ RÃ¤tsel ${next+1}<br>ðŸ“… ${date.toLocaleString("de-DE")}`;
  card.style.display = "block";

  function tick() {
    const diff = unlockTimes[next] - Date.now();
    if (diff <= 0) {
      cd.textContent = "Freigeschaltet!";
      updateVisibility();
      return;
    }

    const d = Math.floor(diff / 86400000);
    const h = Math.floor(diff % 86400000 / 3600000);
    const m = Math.floor(diff % 3600000 / 60000);
    const s = Math.floor(diff % 60000 / 1000);

    cd.textContent = `${d}T ${h}h ${m}m ${s}s`;
  }

  tick();
  setInterval(tick, 1000);
}



/* ================================================================
   RESTORE PROGRESS
================================================================ */

function restore() {
  nextLetterIndex = 0;

  /* Reset der Anzeige */
  for (const s of lettersSpans) {
    s.textContent = "_";
    s.classList.remove("filled");
  }

  /* Buchstaben wiederherstellen */
  progress.letters ||= [];
  progress.letters.forEach(ch => addLetter(ch));

  updateVisibility();
}
restore();



/* ================================================================
   BURGER-MENÃœ
================================================================ */

document.getElementById("burger").addEventListener("click", () => {
  burger.classList.toggle("open");
  document.getElementById("side-menu").classList.toggle("open");
});



/* ================================================================
   FORTSCHRITT ZURÃœCKSETZEN
================================================================ */

document.getElementById("reset-progress").addEventListener("click", () => {
  if (confirm("Wirklich lÃ¶schen?")) {
    localStorage.removeItem("XMASRIDDLE_GLOBAL");
    location.reload();
  }
});
</script>

</body>
</html>
