<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3eryk? Weihnachtsedition 2025</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #111827;
            color: #e5e7eb;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            background: rgba(30, 41, 59, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .badge {
            background: rgba(148, 163, 184, 0.2);
            padding: 4px 10px;
            border-radius: 8px;
            font-size: 12px;
        }

        button {
            background: #3b82f6;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            color: white;
            font-size: 14px;
            margin-top: 10px;
        }

        button:hover {
            background: #2563eb;
        }

        input {
            padding: 10px;
            width: 100%;
            border-radius: 8px;
            border: 1px solid rgba(148, 163, 184, 0.3);
            background: rgba(255,255,255,0.05);
            color: white;
            margin-top: 10px;
            box-sizing: border-box;
        }

        .message {
            margin-top: 10px;
            font-weight: bold;
        }

        .success { color: #4ade80; }
        .error { color: #f87171; }

        .letter-display {
            margin-top: 10px;
        }

        .letter-badge {
            background: #1e3a8a;
            padding: 6px 10px;
            border-radius: 6px;
            margin-right: 6px;
            display: inline-block;
        }

        .hidden {
            display: none;
        }
        .letters-progress {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .letters-progress span {
            background: rgba(255,255,255,0.1);
            padding: 6px 10px;
            border-radius: 6px;
            display: inline-block;
        }

        #next-unlock-card {
            text-align: center;
        }

        /* Navigation (Burger Men√º) */
        #burger {
            position: fixed;
            top: 20px;
            right: 20px;
            cursor: pointer;
            z-index: 1000;
        }

        #burger div {
            width: 30px;
            height: 4px;
            background: white;
            margin: 6px 0;
            transition: 0.3s;
        }

        #side-menu {
            position: fixed;
            top: 0;
            right: -260px;
            width: 240px;
            height: 100%;
            background: #1f2937;
            padding: 20px;
            transition: 0.3s;
            z-index: 999;
        }

        #side-menu.open {
            right: 0;
        }

        #side-menu a {
            color: white;
            text-decoration: none;
            display: block;
            padding: 10px 0;
        }

        #admin-banner {
            display: none;
            background: #b91c1c;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<div id="burger">
    <div></div>
    <div></div>
    <div></div>
</div>

<nav id="side-menu">
    <h3>Navigation</h3>
    <a href="#">Start</a>
    <a href="#qr-section">QR-Code</a>
    <div id="side-menu-links"></div>
</nav>

<div class="container">

    <div id="admin-banner">ADMIN-MODUS AKTIV</div>

    <div class="card">
        <div class="card-header">
            <span class="badge">Admin</span>
            <h2>Login</h2>
        </div>
        <input type="password" id="admin-pass" placeholder="Passwort eingeben">
        <button id="admin-btn">Login</button>
        <div id="admin-msg" class="message"></div>
    </div>

    <div class="card">
        <div class="card-header">
            <span class="badge">Intro</span>
            <h2>Weihnachtsvideo</h2>
        </div>

        <iframe 
           src="https://www.youtube.com/embed/TGvnbko2Jio" 
           style="width:100%; height:320px; border-radius:12px; border:none;"
           allowfullscreen></iframe>
    </div>

    <div class="card">
        <div class="card-header">
            <span class="badge">√úbersicht</span>
            <h2>Gesammelte Buchstaben</h2>
        </div>
        <div class="letters-progress" id="letters-progress">
            <span>_</span><span>_</span><span>_</span><span>_</span>
            <span>_</span><span>_</span><span>_</span><span>_</span>
            <span>_</span><span>_</span><span>_</span><span>_</span>
            <span>_</span><span>_</span><span>_</span><span>_</span>
            <span>_</span><span>_</span><span>_</span><span>_</span>
            <span>_</span><span>_</span><span>_</span><span>_</span>
            <span>_</span><span>_</span><span>_</span>
        </div>
    </div>

    <div class="card" id="qr-section">
        <div class="card-header">
            <span class="badge">QR</span>
            <h2>QR-Code</h2>
        </div>

        <p>Scanne den QR-Code und finde heraus, was passiert!</p>

        <img src="data:image/png;base64,iVBOR‚Ä¶" 
             style="width:220px; display:block; margin:12px auto; border-radius:8px;">
    </div>

    <!-- ======================================================
         R√ÑTSEL 1 ‚Äì QUIZ
    ======================================================= -->
    <div class="card puzzle-card" data-index="0" id="puzzle1">
        <div class="card-header">
            <span class="badge">R√§tsel 1</span>
            <h2>Quiz</h2>
        </div>

        <!-- Frage 1 -->
        <div class="question-row" data-solution="3" data-letter="3">
            <p><strong>Frage 1:</strong> Aus wie vielen Alben besteht die Trilogie von The Weeknd?</p>
            <input type="text" placeholder="Zahl eingeben">
            <button>Pr√ºfen</button>
            <div class="message"></div>
            <div class="letter-display hidden"><span class="letter-badge">3</span></div>
        </div>

        <!-- Frage 2 -->
        <div class="question-row" data-solution="25.09.2024" data-letter="y">
            <p><strong>Frage 2:</strong> Wann war der erste Call in der Discord-Gruppe 3eryk?</p>
            <label><input type="radio" name="q2" value="12.08.2024"> 12.08.2024</label><br>
            <label><input type="radio" name="q2" value="25.09.2024"> 25.09.2024</label><br>
            <label><input type="radio" name="q2" value="03.10.2024"> 03.10.2024</label><br>
            <label><input type="radio" name="q2" value="18.09.2024"> 18.09.2024</label><br>
            <button>Pr√ºfen</button>
            <div class="message"></div>
            <div class="letter-display hidden"><span class="letter-badge">y</span></div>
        </div>

        <!-- Frage 3 -->
        <div class="question-row"
             data-solution="rot ist meine lieblings zahl im ganzen alphabet"
             data-letter="?">
            <p><strong>Frage 3:</strong> Rot‚Ä¶?</p>
            <input type="text" placeholder="ganzen Satz eingeben">
            <button>Pr√ºfen</button>
            <div class="message"></div>
            <div class="letter-display hidden"><span class="letter-badge">?</span></div>
        </div>

        <!-- Frage 4 -->
        <div class="question-row" data-solution="wann?" data-letter="2">
            <p><strong>Frage 4:</strong> Frage‚Ä¶?</p>
            <input type="text" placeholder="Antwort">
            <button>Pr√ºfen</button>
            <div class="message"></div>
            <div class="letter-display hidden"><span class="letter-badge">2</span></div>
        </div>

        <!-- Frage 5 -->
        <div class="question-row" data-solution="i" data-letter="i">
            <p><strong>Frage 5:</strong> Rabsi, Manuel, Firo... Welche Endung ist die sch√∂nste?</p>
            <input type="text" placeholder="z. B. a">
            <button>Pr√ºfen</button>
            <div class="message"></div>
            <div class="letter-display hidden"><span class="letter-badge">i</span></div>
        </div>

        <!-- Frage 6 -->
        <div class="question-row" data-solution="t" data-letter="t">
            <p><strong>Frage 6:</strong> Firo‚Äôs aktueller Lieblingsbuchstabe‚Ä¶?</p>
            <input type="text" placeholder="Buchstabe">
            <button>Pr√ºfen</button>
            <div class="message"></div>
            <div class="letter-display hidden"><span class="letter-badge">t</span></div>
        </div>

        <!-- Frage 7 -->
        <div class="question-row" data-solution="e" data-letter="e">
            <p><strong>Frage 7:</strong> Welcher Buchstabe kommt am h√§ufigsten in Namen vor?</p>
            <input type="text" placeholder="Buchstabe">
            <button>Pr√ºfen</button>
            <div class="message"></div>
            <div class="letter-display hidden"><span class="letter-badge">e</span></div>
        </div>

        <!-- Frage 8 -->
        <div class="question-row" data-solution="47" data-letter="d">
            <p><strong>Frage 8:</strong> Wie viele Medien/Links/Docs wurden bisher geteilt?</p>
            <label><input type="radio" name="q8" value="23"> 23</label><br>
            <label><input type="radio" name="q8" value="69"> 69</label><br>
            <label><input type="radio" name="q8" value="83"> 83</label><br>
            <label><input type="radio" name="q8" value="47"> 47</label><br>
            <button>Pr√ºfen</button>
            <div class="message"></div>
            <div class="letter-display hidden"><span class="letter-badge">d</span></div>
        </div>

        <div id="quiz-summary" class="message"></div>
    </div>

    <!-- ======================================================
         R√ÑTSEL 2 ‚Äì Platzhalter (Wird Minecraft!)
    ======================================================= -->
    <div class="card puzzle-card hidden" data-index="1" id="puzzle2"
         data-solution="R2"
         data-letters="abcd">
        <div class="card-header">
            <span class="badge">R√§tsel 2</span>
            <h2>Platzhalter R√§tsel 2</h2>
        </div>

        <input type="text" placeholder="Antwort eingeben">
        <button>Pr√ºfen</button>
        <div class="message"></div>
        <div class="letter-display hidden"></div>
    </div>
    <!-- ======================================================
         R√ÑTSEL 3
    ======================================================= -->
    <div class="card puzzle-card hidden" data-index="2" id="puzzle3"
         data-solution="R3"
         data-letters="k05W">

        <div class="card-header">
            <span class="badge">R√§tsel 3</span>
            <h2>Platzhalter R√§tsel 3</h2>
        </div>

        <input type="text" placeholder="Antwort eingeben">
        <button>Pr√ºfen</button>

        <div class="message"></div>
        <div class="letter-display hidden"></div>
    </div>


    <!-- ======================================================
         R√ÑTSEL 4
    ======================================================= -->
    <div class="card puzzle-card hidden" data-index="3" id="puzzle4"
         data-solution="R4"
         data-letters="ehas">

        <div class="card-header">
            <span class="badge">R√§tsel 4</span>
            <h2>Platzhalter R√§tsel 4</h2>
        </div>

        <input type="text" placeholder="Antwort eingeben">
        <button>Pr√ºfen</button>

        <div class="message"></div>
        <div class="letter-display hidden"></div>
    </div>


    <!-- ======================================================
         R√ÑTSEL 5
    ======================================================= -->
    <div class="card puzzle-card hidden" data-index="4" id="puzzle5"
         data-solution="R5"
         data-letters="eiti">

        <div class="card-header">
            <span class="badge">R√§tsel 5</span>
            <h2>Platzhalter R√§tsel 5</h2>
        </div>

        <input type="text" placeholder="Antwort eingeben">
        <button>Pr√ºfen</button>

        <div class="message"></div>
        <div class="letter-display hidden"></div>
    </div>



    <!-- ======================================================
         R√ÑTSEL 6 ‚Äî Spotify
    ======================================================= -->
    <div class="card puzzle-card hidden" data-index="5" id="puzzle6"
         data-solution="sta"
         data-letters="sta">

        <div class="card-header">
            <span class="badge">R√§tsel 6</span>
            <h2>Spotify-R√§tsel ‚Äì S√£o Paulo</h2>
        </div>

        <p>Scanne den Spotify-Code und gib die drei Buchstaben ein:</p>

        <div style="display:flex; gap:10px; margin-bottom:12px;">
            <input id="sp1" maxlength="1" class="spotify-letter" placeholder="S">
            <input id="sp2" maxlength="1" class="spotify-letter" placeholder="T">
            <input id="sp3" maxlength="1" class="spotify-letter" placeholder="A">
        </div>

        <button id="spotify-check">Pr√ºfen</button>

        <div id="spotify-msg" class="message"></div>
        <div id="spotify-letters" class="letter-display hidden"></div>

    </div>



    <!-- ======================================================
         FINALE
    ======================================================= -->
    <div class="card hidden" id="final-card">
        <div class="card-header">
            <span class="badge">Finale</span>
            <h2>L√∂sungswort</h2>
        </div>

        <input id="final-input" placeholder="3eryk?2025Weihnachtsedition">
        <button id="final-button">Pr√ºfen</button>

        <div id="final-message" class="message"></div>

        <div id="final-video-wrapper" class="hidden" style="margin-top:16px;">
            <p>Gl√ºckwunsch üéâ</p>
            <iframe id="final-video"
                    src="https://www.youtube.com/embed/TGvnbko2Jio"
                    allowfullscreen></iframe>
        </div>
    </div>



    <!-- ======================================================
         ORIGINALER UNLOCK-BLOCK (EXAKT WIE FR√úHER)
    ======================================================= -->
    <div class="card" id="next-unlock-card">
        <div class="card-header">
            <span class="badge">Info</span>
            <h2>N√§chstes R√§tsel</h2>
        </div>

        <p id="unlock-text">Das n√§chste R√§tsel wird freigeschaltet am:</p>
        <p id="unlock-time"></p>
    </div>

    <button id="reset-progress">üîÑ Fortschritt zur√ºcksetzen</button>

</div> <!-- end container -->


<!-- ======================================================
     JAVASCRIPT
====================================================== -->
<script>
console.log("Seite geladen");

let progress = JSON.parse(localStorage.getItem("XMASRIDDLE_GLOBAL") || "{}");
let ADMIN_MODE = false;

const lettersSpans = document.querySelectorAll("#letters-progress span");
let nextLetterIndex = 0;

function saveProgress(){
    localStorage.setItem("XMASRIDDLE_GLOBAL", JSON.stringify(progress));
}

function addLetter(letter){
    if(nextLetterIndex < lettersSpans.length){
        lettersSpans[nextLetterIndex].textContent = letter;
        lettersSpans[nextLetterIndex].classList.add("filled");
        nextLetterIndex++;
    }
}
/* -----------------------------------------------------
    QUIZ-LOGIK
----------------------------------------------------- */
const quizRows = document.querySelectorAll(".question-row");
const quizSummary = document.getElementById("quiz-summary");
let quizSolvedCount = 0;

quizRows.forEach(row=>{
    const solution = row.dataset.solution.toLowerCase();
    const letter = row.dataset.letter;

    const input = row.querySelector("input[type=text]");
    const radios = row.querySelectorAll("input[type=radio]");
    const button = row.querySelector("button");
    const msg = row.querySelector(".message");
    const display = row.querySelector(".letter-display");

    button.addEventListener("click", ()=>{

        let value = "";
        if(input){
            value = input.value.trim().toLowerCase();
        } else if(radios.length){
            const checked = [...radios].find(r=>r.checked);
            if(checked) value = checked.value.toLowerCase();
        }

        if(!value){
            msg.textContent = "Bitte etwas eingeben.";
            msg.className = "message error";
            return;
        }

        if(value === solution){

            if(row.dataset.solved === "true"){
                msg.textContent = "Schon gel√∂st.";
                msg.className = "message success";
                return;
            }

            row.dataset.solved = "true";
            if(input) input.disabled = true;
            radios.forEach(r=>r.disabled = true);
            button.disabled = true;

            msg.textContent = "Korrekt!";
            msg.className = "message success";

            display.classList.remove("hidden");
            addLetter(letter);

            quizSolvedCount++;
            progress.solvedQuiz ||= [];
            progress.solvedQuiz.push(solution);
            progress.solvedPuzzles ||= {};
            progress.solvedPuzzles[0] = true;

            saveProgress();

            if(quizSolvedCount === 8){
                quizSummary.textContent = "Alle 8 Fragen gel√∂st! üéâ";
                quizSummary.className = "message success";
            }

            updateVisibility();
        } else {
            msg.textContent = "Falsch!";
            msg.className = "message error";
        }
    });
});


/* -----------------------------------------------------
    UNLOCK SYSTEM ‚Äì ORIGINAL LOGIK
----------------------------------------------------- */

const unlockSchedule = {
    0: 0,   // R√§tsel 1 sofort offen
    1: 0,   // R√§tsel 2 soll sp√§ter ge√§ndert werden!
    2: 0,
    3: 0,
    4: 0,
    5: 0
};

function isUnlocked(index){
    return Date.now() >= unlockSchedule[index];
}

function updateNextUnlockInfo(){

    const textEl = document.getElementById("unlock-text");
    const timeEl = document.getElementById("unlock-time");

    if(!textEl || !timeEl) return;

    let nextIndex = null;

    for(let i=0; i<=5; i++){
        if(!isUnlocked(i)){
            nextIndex = i;
            break;
        }
    }

    if(nextIndex === null){
        textEl.textContent = "Alle R√§tsel sind freigeschaltet!";
        timeEl.textContent = "";
        return;
    }

    const date = new Date(unlockSchedule[nextIndex]);

    const d = date.toLocaleString("de-DE", {
        day:"2-digit", month:"2-digit", year:"numeric",
        hour:"2-digit", minute:"2-digit"
    });

    textEl.textContent = "Das n√§chste R√§tsel wird freigeschaltet am:";
    timeEl.textContent = d;
}


/* -----------------------------------------------------
    SICHTBARKEIT
----------------------------------------------------- */
function updateVisibility(){

    const cards = document.querySelectorAll(".puzzle-card");
    const finalCard = document.getElementById("final-card");
    const adminBanner = document.getElementById("admin-banner");

    cards.forEach(c => c.classList.add("hidden"));
    if(finalCard) finalCard.classList.add("hidden");

    adminBanner.style.display = ADMIN_MODE ? "block" : "none";

    if(ADMIN_MODE){
        cards.forEach(c => c.classList.remove("hidden"));
        if(finalCard) finalCard.classList.remove("hidden");
        updateNextUnlockInfo();
        updateNavMenu();
        return;
    }

    // R√§tsel 1 immer offen
    cards[0].classList.remove("hidden");

    // R√§tsel 2‚Äì6 abh√§ngig von vorherigem Puzzle
    if(progress.solvedPuzzles?.[0]) cards[1].classList.remove("hidden");
    if(progress.solvedPuzzles?.[1]) cards[2].classList.remove("hidden");
    if(progress.solvedPuzzles?.[2]) cards[3].classList.remove("hidden");
    if(progress.solvedPuzzles?.[3]) cards[4].classList.remove("hidden");
    if(progress.solvedPuzzles?.[4]) cards[5].classList.remove("hidden");

    if([0,1,2,3,4,5].every(x => progress.solvedPuzzles?.[x])){
        if(finalCard) finalCard.classList.remove("hidden");
    }

    updateNextUnlockInfo();
    updateNavMenu();
}


/* -----------------------------------------------------
    SPOTIFY R√ÑTSEL
----------------------------------------------------- */
document.getElementById("spotify-check").addEventListener("click",()=>{

    const a = sp1.value.toLowerCase();
    const b = sp2.value.toLowerCase();
    const c = sp3.value.toLowerCase();

    const msg = document.getElementById("spotify-msg");
    const disp = document.getElementById("spotify-letters");

    if(!a || !b || !c){
        msg.textContent = "Bitte alle Felder ausf√ºllen!";
        msg.className = "message error";
        return;
    }

    if(a==="s" && b==="t" && c==="a"){

        msg.textContent = "Korrekt!";
        msg.className = "message success";

        sp1.disabled = sp2.disabled = sp3.disabled = true;
        document.getElementById("spotify-check").disabled = true;

        disp.innerHTML =
            `Zeichen:
             <span class='letter-badge'>s</span>
             <span class='letter-badge'>t</span>
             <span class='letter-badge'>a</span>`;
        disp.classList.remove("hidden");

        progress.letters ||= [];
        progress.letters.push("s","t","a");
        progress.solvedPuzzles ||= {};
        progress.solvedPuzzles[5] = true;

        saveProgress();
        updateVisibility();
    } else {
        msg.textContent = "Falsch!";
        msg.className = "message error";
    }
});


/* -----------------------------------------------------
    ADMIN LOGIN
----------------------------------------------------- */
document.getElementById("admin-btn").addEventListener("click",()=>{

    const pw = document.getElementById("admin-pass").value.trim();
    const msg = document.getElementById("admin-msg");

    if(pw === "4321"){
        ADMIN_MODE = true;
        msg.textContent = "Admin-Modus aktiviert!";
        msg.className = "message success";
        updateVisibility();
    } else {
        msg.textContent = "Falsches Passwort.";
        msg.className = "message error";
    }
});


/* -----------------------------------------------------
    RESET BUTTON
----------------------------------------------------- */
document.getElementById("reset-progress").addEventListener("click",()=>{
    localStorage.removeItem("XMASRIDDLE_GLOBAL");
    location.reload();
});


/* -----------------------------------------------------
    RESTORE PROGRESS
----------------------------------------------------- */
function restoreProgress(){

    nextLetterIndex = 0;
    lettersSpans.forEach(s=>{
        s.textContent = "_";
        s.classList.remove("filled");
    });

    if(progress.letters){
        progress.letters.forEach(ch => addLetter(ch));
    }

    quizSolvedCount = 0;

    quizRows.forEach(row=>{
        const input=row.querySelector("input[type=text]");
        const radios=row.querySelectorAll("input[type=radio]");
        const btn=row.querySelector("button");
        const msg=row.querySelector(".message");
        const disp=row.querySelector(".letter-display");

        const sol=row.dataset.solution.toLowerCase();

        if(progress.solvedQuiz?.includes(sol)){

            row.dataset.solved="true";
            if(input) input.disabled=true;
            radios.forEach(r=>r.disabled=true);
            btn.disabled=true;

            msg.textContent="Korrekt (geladen)";
            msg.className="message success";

            disp.classList.remove("hidden");

            quizSolvedCount++;

        } else {
            row.dataset.solved="false";
            if(input) input.disabled=false;
            radios.forEach(r=>{r.disabled=false; r.checked=false;});
            btn.disabled=false;

            msg.textContent="";
            disp.classList.add("hidden");
        }
    });

    if(quizSolvedCount===8){
        quizSummary.textContent="Alle 8 Fragen gel√∂st! üéâ";
        quizSummary.className="message success";
    }

    updateVisibility();
}

restoreProgress();


/* -----------------------------------------------------
    BURGER MEN√ú
----------------------------------------------------- */
const burger = document.getElementById("burger");
const menu = document.getElementById("side-menu");

burger.addEventListener("click",()=>{
    menu.classList.toggle("open");
});

</script>

</body>
</html>
