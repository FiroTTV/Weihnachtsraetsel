<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>3eryk? WeihnachtsrÃ¤tsel ðŸŽ„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg: #020617;
      --card-bg: rgba(15, 23, 42, 0.9);
      --border: rgba(148, 163, 184, 0.3);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --accent: #38bdf8;
      --error: #f97373;
      --success: #4ade80;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at top, #1e293b 0, #020617 55%);
      color: var(--text-main);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Schneeflocken */
    .snowflake {
      position: fixed;
      top: -10px;
      color: #fff;
      opacity: 0.8;
      user-select: none;
      pointer-events: none;
      z-index: 5;
      animation: fall linear infinite;
    }
    @keyframes fall { to { transform: translateY(110vh); } }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 32px 16px 64px;
    }

    .title { text-align: center; margin-bottom: 24px; }
    .title h1 { margin: 0; font-size: clamp(1.8rem, 3vw, 2.4rem); }

    /* Countdown */
    #countdown {
      margin-top: 16px;
      font-size: 2.2rem;
      font-weight: 800;
      color: var(--accent);
      text-shadow: 0 0 10px rgba(56, 189, 248, 0.7);
      animation: pulseGlow 2.2s ease-in-out infinite;
    }
    @keyframes pulseGlow {
      0% { transform: scale(1); text-shadow: 0 0 12px rgba(56,189,248,0.6); }
      50% { transform: scale(1.05); text-shadow: 0 0 20px rgba(56,189,248,1); }
      100% { transform: scale(1); text-shadow: 0 0 12px rgba(56,189,248,0.6); }
    }

    /* Karten */
    .card {
      background: var(--card-bg);
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 20px 18px;
      margin-bottom: 18px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.5);
    }
    .card-header { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
    .badge {
      font-size: 0.75rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      color: var(--text-muted);
    }

    iframe {
      width: 100%;
      max-width: 600px;
      height: 338px;
      margin: 0 auto;
      display: block;
      border-radius: 12px;
      border: none;
      background: #020617;
    }

    /* Buchstabenfortschritt */
    .letters-progress { display: flex; flex-wrap: wrap; gap: 6px; }
    .letters-progress span {
      width: 20px;
      text-align: center;
      padding: 3px 0;
      border-radius: 6px;
      background: rgba(15,23,42,0.7);
      border: 1px solid rgba(148,163,184,0.35);
      font-size: 0.9rem;
    }
    .letters-progress span.filled { border-color: var(--accent); }

    /* Inputs */
    input[type="text"], input[type="password"] {
      width: 100%;
      padding: 10px 14px;
      margin-top: 6px;
      font-size: 1rem;
      border-radius: 10px;
      border: 1px solid rgba(148,163,184,0.25);
      background: rgba(255,255,255,0.06);
      color: #e5e7eb;
      outline: none;
      transition: 0.25s ease;
      box-sizing: border-box;
    }
    input:hover { border-color: rgba(148,163,184,0.4); }
    input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 12px rgba(56,189,248,0.45);
      background: rgba(255,255,255,0.10);
    }

    .question-row {
      background: rgba(255,255,255,0.03);
      padding: 14px 16px;
      border-radius: 12px;
      border: 1px solid rgba(148,163,184,0.15);
      margin-bottom: 14px;
    }

    .message.success { color: var(--success); margin-top: 6px; }
    .message.error { color: var(--error); margin-top: 6px; }

    button {
      padding: 8px 18px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      color: white;
      background: linear-gradient(90deg, #3b82f6, #a855f7);
      transition: 0.2s;
    }
    button:hover { transform: scale(1.04); }

    /* BURGERMENÃœ */
    #burger-btn {
      position: fixed;
      right: 22px;
      top: 22px;
      z-index: 9999;
      cursor: pointer;
      font-size: 28px;
      background: rgba(0,0,0,0.4);
      padding: 8px 10px;
      border-radius: 8px;
    }
    #side-menu {
      position: fixed;
      right: -260px;
      top: 0;
      width: 240px;
      height: 100vh;
      background: rgba(15,23,42,0.97);
      padding: 20px;
      border-left: 1px solid rgba(255,255,255,0.12);
      transition: 0.3s ease;
      z-index: 9998;
    }
    #side-menu.active { right: 0; }

    #side-menu ul { list-style: none; padding: 0; margin: 0; }
    #side-menu li {
      padding: 12px;
      margin-bottom: 10px;
      border-radius: 10px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.15);
      cursor: pointer;
    }
    #side-menu li.locked { opacity: 0.45; cursor: not-allowed; }

    #menu-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      display: none;
      z-index: 9997;
    }
    #menu-overlay.active { display: block; }
  </style>
</head>
<body>

<div id="burger-btn">â˜°</div>
<nav id="side-menu">
  <ul>
    <li data-target="puzzle1" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="puzzle2" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="puzzle3" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="puzzle4" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="puzzle5" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="puzzle6" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
    <li data-target="final-card" class="locked"><span class="label">ðŸ”’ Gesperrt</span></li>
  </ul>
</nav>
<div id="menu-overlay"></div>

<div class="container">
  <div class="title">
    <h1>ðŸŽ„ 3eryk? WeihnachtsrÃ¤tsel â€“ 2025 Edition ðŸŽ„</h1>
    <div id="countdown">Lade Countdown...</div>
  </div>

  <!-- ADMIN LOGIN -->
  <div class="card" id="admin-login">
    <div class="card-header">
      <span class="badge">Admin</span><h2>Admin Login</h2>
    </div>
    <p>Passwort eingeben:</p>
    <input id="admin-pass" type="password">
    <button id="admin-btn">Login</button>
    <div id="admin-msg" class="message"></div>
  </div>

  <!-- INTRO VIDEO -->
  <div class="card">
    <div class="card-header">
      <span class="badge">Intro</span><h2>Willkommen!</h2>
    </div>
    <iframe src="https://www.youtube.com/embed/TGvnbko2Jio?si=z0f59smM_qRPTszH" allowfullscreen></iframe>
  </div>

  <!-- QR CODE INFO -->
  <div class="card">
    <div class="card-header">
      <span class="badge">Info</span><h2>QR-Code</h2>
    </div>
    <p>QR-Code: Findet alle Teile des QR-Codes mithilfe von Firoâ€¦</p>
  </div>
  <!-- RÃ„TSEL 1 â€“ QUIZ -->
  <div class="card hidden" id="puzzle1">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 1</span>
      <h2>Quiz â€“ 8 Fragen</h2>
    </div>

    <p id="quiz-progress">0 von 8 gelÃ¶st</p>

    <!-- Frage 1 -->
    <div class="question-row">
      <p>1. Aus wie vielen Alben besteht die Trilogie von TheWeeknd?</p>
      <input id="q1" placeholder="Antwort eingeben...">
      <button onclick="checkQuiz(1)">PrÃ¼fen</button>
      <div id="m1" class="message"></div>
    </div>

    <!-- Frage 2 -->
    <div class="question-row">
      <p>2. Wann war der erste Call in der Discord Gruppe 3eryk?</p>
      <input id="q2" placeholder="Antwort eingeben... (TT.MM.JJJJ)">
      <button onclick="checkQuiz(2)">PrÃ¼fen</button>
      <div id="m2" class="message"></div>
    </div>

    <!-- Frage 3 -->
    <div class="question-row">
      <p>3. Rot....?</p>
      <input id="q3" placeholder="ganzen Satz eingeben">
      <button onclick="checkQuiz(3)">PrÃ¼fen</button>
      <div id="m3" class="message"></div>
    </div>

    <!-- Frage 4 -->
    <div class="question-row">
      <p>4. Frage...?</p>
      <input id="q4" placeholder="Antwort eingeben...">
      <button onclick="checkQuiz(4)">PrÃ¼fen</button>
      <div id="m4" class="message"></div>
    </div>

    <!-- Frage 5 -->
    <div class="question-row">
      <p>5. Rabsi, Manuel, Firoâ€¦ Doch welche Endung ist die schÃ¶nste?</p>
      <input id="q5" placeholder="Buchstabe eingeben">
      <button onclick="checkQuiz(5)">PrÃ¼fen</button>
      <div id="m5" class="message"></div>
    </div>

    <!-- Frage 6 -->
    <div class="question-row">
      <p>6. Firos aktueller Lieblingsbuchstabeâ€¦?</p>
      <input id="q6" placeholder="Antwort eingeben...">
      <button onclick="checkQuiz(6)">PrÃ¼fen</button>
      <div id="m6" class="message"></div>
    </div>

    <!-- Frage 7 -->
    <div class="question-row">
      <p>7. Firo findet Namen seit Neuestem attraktivâ€¦ Doch welcher Buchstabe ist der verbreitetste?</p>
      <input id="q7" placeholder="Antwort eingeben...">
      <button onclick="checkQuiz(7)">PrÃ¼fen</button>
      <div id="m7" class="message"></div>
    </div>

    <!-- Frage 8 -->
    <div class="question-row">
      <p>8. Wie viele Medien wurden in der WhatsApp-Gruppe geteilt? (MC: 23 / 69 / 83 / 47)</p>
      <input id="q8" placeholder="Antwort eingeben...">
      <button onclick="checkQuiz(8)">PrÃ¼fen</button>
      <div id="m8" class="message"></div>
    </div>

  </div> <!-- /RÃ¤tsel 1 -->


  <!-- NÃ„CHSTES RÃ„TSEL -->
  <div class="card" id="next-unlock-card">
    <div class="card-header">
      <span class="badge">Info</span>
      <h2>NÃ¤chstes RÃ¤tsel</h2>
    </div>

    <p id="next-riddle-text">Ladeâ€¦</p>
    <div id="next-riddle-countdown" style="font-size: 1.5rem; color: var(--accent);"></div>

    <div style="text-align:center; margin-top:10px; font-size:32px; opacity:0.8;">
      ðŸ”’
    </div>
  </div>


  <!-- RÃ„TSEL 2 -->
  <div class="card hidden" id="puzzle2">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 2</span><h2>RÃ¤tsel erscheint am 08.12.</h2>
    </div>
    <p>Wird automatisch freigeschaltet.</p>
  </div>

  <!-- RÃ„TSEL 3 -->
  <div class="card hidden" id="puzzle3">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 3</span><h2>RÃ¤tsel erscheint am 10.12.</h2>
    </div>
    <p>Wird automatisch freigeschaltet.</p>
  </div>

  <!-- RÃ„TSEL 4 -->
  <div class="card hidden" id="puzzle4">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 4</span><h2>RÃ¤tsel erscheint am 16.12.</h2>
    </div>
    <p>Wird automatisch freigeschaltet.</p>
  </div>

  <!-- RÃ„TSEL 5 -->
  <div class="card hidden" id="puzzle5">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 5</span><h2>RÃ¤tsel erscheint am 22.12.</h2>
    </div>
    <p>Wird automatisch freigeschaltet.</p>
  </div>

  <!-- RÃ„TSEL 6 â€“ SPOTIFY -->
  <div class="card hidden" id="puzzle6">
    <div class="card-header">
      <span class="badge">RÃ¤tsel 6</span><h2>Spotify RÃ¤tsel</h2>
    </div>

    <p>Song-Code eingeben (3 Buchstaben):</p>

    <div class="question-row">
      <input id="sp1" maxlength="1" placeholder="1. Buchstabe">
      <input id="sp2" maxlength="1" placeholder="2. Buchstabe" style="margin-top:10px;">
      <input id="sp3" maxlength="1" placeholder="3. Buchstabe" style="margin-top:10px;">
      <button onclick="checkSpotify()">PrÃ¼fen</button>
      <div id="sp-msg" class="message"></div>
    </div>
  </div>


  <!-- FINALES LÃ–SUNGSWORT -->
  <div class="card hidden" id="final-card">
    <div class="card-header">
      <span class="badge">Ende</span><h2>Finales LÃ¶sungswort</h2>
    </div>

    <p>Hier endgÃ¼ltiges LÃ¶sungswort eingeben:</p>
    <input id="final-input">
    <button onclick="checkFinal()">PrÃ¼fen</button>
    <div id="final-msg" class="message"></div>
  </div>


  <!-- RESET -->
  <button id="reset-progress"
          style="background: linear-gradient(90deg,#ef4444,#f97316); margin-top:40px;">
    Fortschritt zurÃ¼cksetzen
  </button>

</div> <!-- /container -->
<script>
/* ============================================================
   SNOW (wie zuvor)
============================================================ */
function createSnowflake() {
  const s = document.createElement("div");
  s.className = "snowflake";
  s.textContent = "â„";
  s.style.left = Math.random() * 100 + "vw";
  s.style.fontSize = 10 + Math.random() * 18 + "px";
  s.style.animationDuration = 4 + Math.random() * 6 + "s";
  s.style.opacity = 0.4 + Math.random() * 0.4;
  document.body.appendChild(s);
  setTimeout(() => s.remove(), 11000);
}
setInterval(createSnowflake, 200);


/* ============================================================
   AUDIO CLICK
============================================================ */
let audioCtx = null;
function getAudioCtx() {
  if (!audioCtx) {
    const C = window.AudioContext || window.webkitAudioContext;
    audioCtx = new C();
  }
  return audioCtx;
}
function playClick() {
  const ctx = getAudioCtx();
  const osc = ctx.createOscillator();
  const gain = ctx.createGain();

  osc.frequency.value = 220;
  gain.gain.value = 0.12;

  osc.connect(gain);
  gain.connect(ctx.destination);

  osc.start();
  osc.stop(ctx.currentTime + 0.08);
}


/* ============================================================
   RÃ„TSEL-UNLOCK-DATEN
============================================================ */
const unlockTimes = {
  1: new Date("2025-12-01T18:00:00"),
  2: new Date("2025-12-08T18:00:00"),
  3: new Date("2025-12-10T18:00:00"),
  4: new Date("2025-12-16T18:00:00"),
  5: new Date("2025-12-22T18:00:00"),
  6: new Date("2025-12-28T20:00:00")
};

const finalUnlock = unlockTimes[6];


/* ============================================================
   ADMIN LOGIN
============================================================ */
const ADMIN_PASS = "FIRO-MADE-THIS";

let adminMode = false;
if (localStorage.getItem("adminMode") === "true") {
  adminMode = true;
}

function tryAdminLogin() {
  playClick();
  const inp = document.getElementById("admin-password");
  if (!inp) return;

  if (inp.value === ADMIN_PASS) {
    adminMode = true;
    localStorage.setItem("adminMode", "true");
    alert("Admin aktiviert");
    location.reload();
  } else {
    alert("Falsches Passwort");
  }
}


/* ============================================================
   FUNKTION: PrÃ¼ft, ob RÃ¤tsel freigeschaltet ist
============================================================ */
function puzzleIsUnlocked(id) {
  if (adminMode) return true;
  return new Date() >= unlockTimes[id];
}


/* ============================================================
   TIMER FORMAT
============================================================ */
function formatRemaining(d) {
  if (d <= 0) return "Jetzt!";

  let sec = Math.floor(d / 1000);
  const days = Math.floor(sec / 86400);
  sec %= 86400;
  const hours = Math.floor(sec / 3600);
  sec %= 3600;
  const minutes = Math.floor(sec / 60);
  sec %= 60;

  let out = "";
  if (days > 0) out += `${days}T `;
  if (hours > 0) out += `${hours}h `;
  if (minutes > 0) out += `${minutes}m `;
  out += `${sec}s`;

  return out.trim();
}


/* ============================================================
   NEXT-RIDDLE-BOX aktualisieren
============================================================ */
function updateNextRiddleBox() {
  const box = document.getElementById("next-riddle-card");
  const text = document.getElementById("next-riddle-text");
  const countdown = document.getElementById("next-riddle-countdown");
  if (!box) return;

  // Finde das nÃ¤chste RÃ¤tsel, welches noch zu ist
  let next = null;
  for (let i = 1; i <= 6; i++) {
    if (!puzzleIsUnlocked(i)) {
      next = i;
      break;
    }
  }

  if (!next) {
    text.textContent = "Alle RÃ¤tsel sind freigeschaltet!";
    countdown.textContent = "";
    return;
  }

  text.textContent = `RÃ¤tsel ${next} wird freigeschaltet in:`;

  function tick() {
    const diff = unlockTimes[next] - new Date();
    countdown.textContent = formatRemaining(diff);
    if (diff <= 0 && !adminMode) {
      location.reload();
    }
  }
  tick();
  setInterval(tick, 1000);
}


/* ============================================================
   RÃ„TSEL-SICHTBARKEIT
============================================================ */
function applyPuzzleVisibility() {
  for (let i = 1; i <= 6; i++) {
    const card = document.getElementById("puzzle" + i);
    if (!card) continue;

    if (puzzleIsUnlocked(i)) {
      card.classList.remove("hidden");
    } else {
      card.classList.add("hidden");
    }
  }
}


/* ============================================================
   QUIZ â€“ LÃ–SUNGEN
============================================================ */
const quizSolutions = {
  1: { solution: "3", letter: "3" },
  2: { solution: "25.09.2024", letter: "e" },
  3: { solution: "Rot ist meine lieblings Zahl im ganzen Alphabet".toLowerCase(), letter: "r" },
  4: { solution: "wann", letter: "y" },
  5: { solution: "i", letter: "k" },
  6: { solution: "t", letter: "?" },
  7: { solution: "e", letter: "2" },
  8: { solution: "47", letter: "0" }
};

/* Speichere Quiz-Fortschritt */
let quizState = JSON.parse(localStorage.getItem("quizProgress") || "{}");

function saveQuizState() {
  localStorage.setItem("quizProgress", JSON.stringify(quizState));
}

function updateQuizProgressUI() {
  const solved = Object.keys(quizState).length;
  const el = document.getElementById("quiz-progress");
  if (el) el.textContent = `${solved} von 8 gelÃ¶st`;
}

function checkQuiz(n) {
  playClick();
  const inp = document.getElementById("q" + n);
  const msg = document.getElementById("m" + n);
  if (!inp || !msg) return;

  const user = inp.value.trim().toLowerCase();
  const correct = quizSolutions[n].solution.toLowerCase();

  if (user === correct) {
    msg.textContent = `Richtig! Du erhÃ¤ltst: ${quizSolutions[n].letter}`;
    msg.className = "message success";
    quizState[n] = quizSolutions[n].letter;
    saveQuizState();
    updateQuizProgressUI();
  } else {
    msg.textContent = "Falsch!";
    msg.className = "message error";
  }
}


/* ============================================================
   SPOTIFY-RÃ„TSEL
============================================================ */
function checkSpotify() {
  playClick();
  const a = document.getElementById("sp1").value.toLowerCase();
  const b = document.getElementById("sp2").value.toLowerCase();
  const c = document.getElementById("sp3").value.toLowerCase();
  const msg = document.getElementById("sp-msg");

  if (a + b + c === "sta") {
    msg.textContent = "Richtig! Zeichen: 5";
    msg.className = "message success";
    localStorage.setItem("spotifySolved", "5");
  } else {
    msg.textContent = "Falsch!";
    msg.className = "message error";
  }
}


/* ============================================================
   FINALE LÃ–SUNG
============================================================ */
function checkFinal() {
  playClick();
  const val = document.getElementById("final-input").value.trim();
  const msg = document.getElementById("final-msg");
  if (!msg) return;

  if (val === "3eryk?2025Weihnachtsedition") {
    msg.textContent = "KORREKT! ðŸŽ‰";
    msg.className = "message success";
  } else {
    msg.textContent = "Leider falsch...";
    msg.className = "message error";
  }
}


/* ============================================================
   BURGER-MENÃœ LOGIK
============================================================ */
function toggleMenu() {
  const m = document.getElementById("mobile-menu");
  if (m.classList.contains("open")) {
    m.classList.remove("open");
  } else {
    m.classList.add("open");
  }
}

function jumpTo(id) {
  playClick();
  document.getElementById("mobile-menu").classList.remove("open");
  const el = document.getElementById(id);
  if (el) el.scrollIntoView({ behavior: "smooth" });
}


/* ============================================================
   INITIALISIERUNG
============================================================ */
window.onload = () => {
  applyPuzzleVisibility();
  updateNextRiddleBox();
  updateQuizProgressUI();
};
</script>

